{% extends "base.html" %}

{% block title %} confirmação {% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/confirmation.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.min.css') }}">


{% endblock %}

{% block extra_js %}
    <script src="{{ url_for('static', filename='js/btnpayment.js') }}" type="module"></script>
    <script src="{{ url_for('static', filename='js/bootstrap.bundle.min.js') }}"></script>
{% endblock %}

{% block content %}
<div class="main-wrapper">

    <h2 class="titulo">Últimos detalhes</h2>

    <div class="content-grid">
        
        <div class="card-box">
            <h3>Confirmação da data</h3>

            <div class="dupla">
                <div>
                    <p class="subtitulo">Retirada</p>
                    <p>{{ pickup.branch.name }}</p>
                    <p>{{ pickup.branch.address.name() }}</p>
                    <p>{{ pickup.date_br }}</p>
                    <p>{{ pickup.time }}</p>
                </div>

                <div>
                    <p class="subtitulo">Devolução</p>
                    <p>{{ dropoff.branch.name }}</p>
                    <p>{{ dropoff.branch.address.name() }}</p>
                    <p>{{ dropoff.date_br }}</p>
                    <p>{{ dropoff.time }}</p>
                </div>
            </div>
        </div>

        <div class="card-box">
            <h3>Resumo do valor</h3>
            <div class="linha"><span>Valor do veículo</span><span>{{ vehicle.daily_price | currency }}/dia</span></div>
            <div class="linha"><span>Total</span><span>{{ rental.vehicle_total | currency }}</span></div>
            <hr>
            <div class="linha"><span>Adicionais</span></div>
            {% for rental_extra in rental_extras %}
                {% if rental_extra.extra.selectable_quantity %}
                    <div class="linha"><span>{{ rental_extra.quantity }} X {{ rental_extra.extra.name }}</span><span>{{ rental_extra.extra.daily_price | currency }}/dia</span></div>
                {% else %}
                    <div class="linha"><span>{{ rental_extra.extra.name }}</span><span>{{ rental_extra.extra.daily_price | currency }}/dia</span></div>
                {% endif %}
            {% endfor %}
            <div class="linha"><span>Total</span><span>{{ rental.extras_daily_price | currency }}</span></div>
            <hr>
            <div class="linha"><span>Taxas da locadora</span><span>12% = {{ rental.fee_price | currency }}</span></div>
            <hr>
            <div class="linha total"><span>Total</span><span>{{ rental.total | currency }}</span></div>
        </div>
    </div>

    <div class="card-box payment-section">
        <h3>Confirmação do pagamento</h3>

        <p class="subtitulo">Opções de pagamento</p>

        <div class="pag-opcoes">
            <button class="payment-option" id="btnpay">Cartão de crédito</button>
            <button class="payment-option">PIX</button>
            <button class="payment-option">Boleto</button>
        </div>

        <form action="{{ url_for('main.confirmation') }}" method="post" id="confirm-form">
            <button class="btn-confirm" type="submit" id="btn-confirm" data-confirmation-email="{{ url_for('main.confirmation_email') }}">Confirmar reserva</button>
        </form>


        <div class="modal fade" id="loadingModal" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content text-center p-4 border-0 shadow-sm">
                <div class="spinner-border" role="status" style="width: 3rem; height: 3rem;"></div>
                <p class="mt-3 mb-0 fs-5">Registrando a locação...</p>
                </div>
            </div>
        </div>


    </div>

</div>

{% endblock %}